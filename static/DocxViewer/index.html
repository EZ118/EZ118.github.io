<!DOCTYPE html>
<html>
	<meta charset="utf-8">
	<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
	<title>Docx Viewer</title>
<head>
	<script src="./docx2html.min.js"></script>
	<style>
		.TitleBar{
			position:fixed; top:0px; left:0px; z-index:10;
			width:100%; height:40px; padding:5px;
			background:#185ABD; color:#FFF; box-shadow: 0px 1px 5px #000;
		}
		#OneDrag{
			position:fixed; top:0px; left:0px; z-index:11;
			width:100%;
			height: 40px;
		}
		#container{
			margin-bottom:20px; margin-top:50px;
			background:#FFF; box-shadow: 0px 0px 5px #000;
		}
		body{background-color: rgb(50, 54, 57);}
	</style>
</head>
<body>
	<table class="TitleBar"><tr>
		<td width="5px"></td>
		<td align="left"><label>Word</label></td>
		<td align="right"><label style="color:rgba(200, 200, 200, 0.3);">Drag&amp;Drop Here To Open</label></td>
		<!--<td align="right"><input type="file" onchange="docx2h5(this)"/></td>-->
	</tr></table>
	
	<center>
		<div id="container" style="display:none;border:none; text-align:left; width:fit-content; min-height:500px;"></div>
		<div id="OneDrag" style="width: 90%;height: 40px; background:rgba(200, 200, 200, 0.0);"></div>
	</center>
	
	<script type="text/javascript">
		function docx2h5(input){
			document.getElementById("container").innerHTML = "";
			require("docx2html")(input.files[0],{container:document.getElementById("container")})
				.then(html=>{
					input.value=""
				});
		}
		
		OneDrag = document.getElementById("OneDrag");
		OneDrag.setAttribute("style", "height: 40px;");
		OneDrag.ondragover = function(e) {
			e.preventDefault();
			OneDrag.setAttribute("style", "background:rgba(200, 200, 200, 0.5);");
		}
		OneDrag.ondrop = function(e) {
			e.preventDefault();
			OneDrag.setAttribute("style", "background:rgba(200, 200, 200, 0.0);");
			
			docx2h5(e.dataTransfer);
			document.getElementById("container").setAttribute("style", "display:block;border:1px solid #000; text-align:left; width:fit-content; min-height:500px;");
		}
		OneDrag.ondragleave = function () {
			OneDrag.setAttribute("style", "background:rgba(200, 200, 200, 0.0);");
		}
	</script>

</body>
</html>